{% extends "perfilBase.html" %} 
{% block content_profile %}

<!-- Account Settings -->
<div class="bg-white rounded-2xl card-shadow p-6 hover-lift">
  <h3 class="text-xl font-semibold text-gray-800 mb-6">Cuenta</h3>

  <div class="space-y-4">
    <button
      class="w-full text-left p-4 border border-gray-200 rounded-xl hover:border-mint transition-colors"
    >
    <a href="{% url 'change_password' %}">
      <div class="flex items-center justify-between">
        <div>
          <h4 class="font-medium text-gray-800">Cambiar contraseña</h4>
          <p class="text-sm text-gray-600">Actualiza tu contraseña de acceso</p>
        </div>
        <i class="fas fa-chevron-right text-gray-400"></i>
      </div>
    </a>
    
    <button
      id="btn-eliminar-cuenta"
      type="button"
      class="w-full text-left p-4 border border-red-200 rounded-xl hover:border-red-300 transition-colors text-red-600"
    >
      <div class="flex items-center justify-between">
        <div>
          <h4 class="font-medium">Eliminar cuenta</h4>
          <p class="text-sm text-red-500">Esta acción no se puede deshacer</p>
        </div>
        <i class="fas fa-chevron-right text-red-400"></i>
      </div>
    </button>

    <!-- Modal de confirmación -->
    <div id="modal-eliminar-cuenta" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div id="modal-eliminar-cuenta-content" class="bg-white rounded-xl shadow-lg p-8 max-w-sm w-full" onclick="event.stopPropagation();">
        <h3 class="text-lg font-semibold mb-4 text-red-600 text-center">¿Eliminar cuenta?</h3>
        <p class="mb-6 text-gray-700 text-center">Esta acción es irreversible.<br>¿Seguro que deseas eliminar tu cuenta?</p>
        <form method="post" class="space-y-4">
          {% csrf_token %}
          <label for="id_email" class="block text-sm font-medium text-gray-700 mb-1">Confirma tu email para eliminar la cuenta:</label>
          <div>
            {{ form.email }}
          </div>
          {% if form.email.errors %}
            <div class="text-red-500 text-sm mt-1">
              {% for error in form.email.errors %}
                <p>{{ error }}</p>
              {% endfor %}
            </div>
          {% endif %}
          <div class="flex flex-col sm:flex-row justify-between gap-2 pt-2">
            <button id="cancelar-eliminar-cuenta" type="button" class="w-full sm:w-auto px-4 py-2 rounded bg-gray-200 hover:bg-gray-300">Cancelar</button>
            <button type="submit" class="w-full sm:w-auto px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700">Eliminar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>



<script>
  (function() {
    const btnEliminar = document.getElementById('btn-eliminar-cuenta');
    const modal = document.getElementById('modal-eliminar-cuenta');
    const modalContent = document.getElementById('modal-eliminar-cuenta-content');
    const cancelar = modal ? modal.querySelector('#cancelar-eliminar-cuenta') : null;
    if(btnEliminar && modal && cancelar) {
      btnEliminar.addEventListener('click', function(e) {
        e.preventDefault();
        modal.classList.remove('hidden');
      });
      cancelar.addEventListener('click', function(e) {
        e.preventDefault();
        modal.classList.add('hidden');
      });
      // Cerrar modal solo si el click es en el fondo, no en el contenido
      modal.addEventListener('click', function(e) {
        if(e.target === modal) {
          modal.classList.add('hidden');
        }
      });
    }
  })();
</script>
{% endblock content_profile %}
